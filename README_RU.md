# FFConverter — Универсальный конвертер данных (GUI)

[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![Python](https://img.shields.io/badge/python-3.8%2B-3776AB.svg)](https://www.python.org/)
[![GUI](https://img.shields.io/badge/UI-Tkinter-1f6feb.svg)](#)
[![Pandas](https://img.shields.io/badge/pandas-required-150458.svg)](https://pandas.pydata.org/)
[![OpenPyXL](https://img.shields.io/badge/openpyxl-required-019733.svg)](https://openpyxl.readthedocs.io/)
[![Tabulate](https://img.shields.io/badge/tabulate-required-4C9A2A.svg)](#)

FFConverter — это десктопное приложение с графическим интерфейсом, созданное с помощью Tkinter для преобразования файлов со структурированными данными между форматами: CSV, XLSX, JSON, XML, YAML, INI, TXT и Markdown. Приложение также поддерживает открытие файлов с исходным кодом на многих языках и их сохранение в виде TXT или Markdown с функцией предварительного просмотра.

## Ключевые особенности

- Автоматическое определение формата входного файла по его расширению и упрощенному анализу содержимого (эвристики для JSON/XML/YAML/INI).
- Поддерживаемые форматы на входе: csv, xlsx, json, xml, yaml/yml, ini, txt, md; файлы с исходным кодом определяются отдельно.
- Поддерживаемые форматы для сохранения данных: csv, xlsx, json, xml, yaml, ini, txt, md.
- Файлы с исходным кодом могут быть сохранены только как TXT или MD (сохраняются строки; синтаксический анализ не производится).
- Панель предварительного просмотра с настраиваемым количеством строк и рендерингом DataFrame в Markdown для табличных данных. Для предварительного просмотра Markdown требуется `tabulate`.
- Простой графический интерфейс: выбор файла, метка с определенным форматом, выпадающий список для выбора целевого формата, кнопка конвертации, строка состояния, прокручиваемая область просмотра.

## Требования

- Python 3.8+ на Windows/macOS/Linux.
- Пакеты: pandas, pyyaml, openpyxl, tabulate, lxml. Скрипт проверяет их наличие при запуске и предлагает установить в случае отсутствия.
- Не требуются внешние исполняемые файлы; все преобразования выполняются в Python с использованием pandas, PyYAML, OpenPyXL, ConfigParser и ElementTree.

## Установка

# 1) Клонируйте репозиторий
git clone https://github.com/VioletSoul/FFConverter.git
cd FFConverter

# 2) (Опционально) Создайте и активируйте виртуальное окружение
python -m venv .venv
# Windows
.venv\Scripts\activate
# macOS/Linux
source .venv/bin/activate

# 3) Установите зависимости
pip install -r requirements.txt  # если файл существует
# или напрямую:
pip install pandas pyyaml openpyxl tabulate lxml

Если зависимости отсутствуют, приложение выведет в консоль инструкцию:
pip install pandas pyyaml openpyxl tabulate lxml
и завершит работу, как это реализовано в блоке `__main__` скрипта.

## Запуск

python ffconverter.py

Это запустит окно Tkinter с заголовком “Универсальный конвертер данных”. Используйте “Выбрать файл”, чтобы открыть поддерживаемый файл, затем выберите целевой формат в выпадающем списке и нажмите “Конвертировать”.

## Определение формата

- Используется расширение для быстрой маршрутизации: .csv, .xlsx, .json, .xml, .yaml/.yml, .ini, .txt, .md. Файлы с исходным кодом, такие как .py, .cpp, .java, .cs, .js, .ts, .go, .rb, .swift, .sh, .bat, .pl, .php, .rs, .scala, .kt, .dart, обрабатываются как “code”.
- Если расширение неоднозначно, инструмент проверяет первые ~2048 символов для определения JSON, XML, YAML или INI с помощью безопасных парсеров; в противном случае по умолчанию используется TXT.

## Логика чтения (кратко)

- code: читается как список строк (без парсинга).
- csv/xlsx: загружается в pandas DataFrame.
- json/yaml: список → DataFrame; словарь → строка DataFrame, если возможно, иначе остается словарем.
- xml: предпринимается попытка простого извлечения таблицы путем итерации дочерних элементов в записи; в качестве запасного варианта используется словарь корневых элементов или строка с ошибкой.
- ini: ConfigParser преобразует в словарь секций, который транспонируется в DataFrame.
- txt/md: читается как список строк.

## Логика сохранения (кратко)

- csv: DataFrame.to_csv(index=False).
- xlsx: DataFrame.to_excel(index=False).
- json: DataFrame.to_json(orient="records", indent=2, UTF-8).
- xml: строится структура <records><record>…</record></records> с XML-безопасными тегами и экранированным текстом.
- yaml: записи DataFrame выгружаются как список словарей с поддержкой Unicode.
- ini: каждая строка DataFrame становится секцией с отображением "столбец→значение".
- md: DataFrame.to_markdown(index=False) требует установленного `tabulate`.
- txt: используется `DataFrame.to_string(index=False)` для создания хорошо отформатированной, выровненной текстовой таблицы.
- code: строки сохраняются без изменений только в TXT/MD.

## Особенности интерфейса

- Тема и цвета для темного интерфейса; пользовательские шрифты для заголовков и предпросмотра.
- Предпросмотр показывает первые N строк (настраивается с помощью Spinbox) с обновлением в реальном времени при изменении значения или потере фокуса.
- Для DataFrame предпросмотр использует рендеринг в Markdown; для списков/строк и кода показывает объединенные строки; для словарей — отформатированный JSON.

## Примечания и ограничения

- Преобразование нетабличных вложенных JSON/YAML/XML может потребовать их выравнивания; инструмент пытается выполнить базовое приведение к DataFrame, но в некоторых случаях может оставить данные в виде словаря/списка.
- Запись XML использует простую схему на основе записей с очисткой тегов и HTML-экранированием текста; атрибуты/вложенные иерархии не сохраняются за пределами плоских записей.
- Файлы с исходным кодом не анализируются и не подсвечиваются синтаксически; они обрабатываются как обычный текст.
- Предварительный просмотр таблиц в Markdown зависит от `pandas.to_markdown`, который требует пакет `tabulate`.

## Устранение неполадок

- Отсутствующие пакеты: установите, как указано, и перезапустите.
  pip install pandas pyyaml openpyxl tabulate lxml

- Проблемы с сохранением Excel: убедитесь, что `openpyxl` установлен, и путь для сохранения доступен для записи.
- Ошибки парсинга YAML/JSON: убедитесь, что кодировка — UTF‑8 и файл валиден; некорректные файлы вызовут исключения.
- Ошибки парсинга XML: убедитесь, что XML хорошо сформирован; частичные/двоичные файлы не могут быть обработаны ElementTree.

## Разработка

- Однофайловое GUI-приложение, использующее стандартную библиотеку Tkinter; не требует специальной настройки, кроме зависимостей.
- Линтинг/форматирование рекомендуется, но не обязательно; в рамках вклада можно рефакторить обработчики чтения/записи в модули.

## Лицензия

Лицензия MIT. Подробности см. в файле LICENSE.
